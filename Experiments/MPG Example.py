# Module Example
# Abraham Oliver, 2016
# Reverse Learning

import numpy as np
from random import randint, random
from csv import reader as CSV

def getMPGDataset():
    # Prepare Data
    data = {"mpg": [], "cylinders": [], "displacement": [], "horsepower": [], "weight": [],
            "acceleration": [], "model_year": [], "origin": [], "car_name": []}
    with open("C:/Users/abeol/Git/ReverseLearning/DataSets/auto-mpg.tab") as tsv:
        reader = CSV(tsv, dialect="excel-tab")
        for line in reader:
            if reader.line_num not in [1, 2, 3] and "?" not in line:
                data["mpg"].append(line[0])
                data["cylinders"].append(line[1])
                data["displacement"].append(line[2])
                data["horsepower"].append(line[3])
                data["weight"].append(line[4])
                data["acceleration"].append(line[5])
                data["model_year"].append(line[6])
                data["origin"].append(line[7])
                data["car_name"].append(line[8])
    # Data in training format
    xs = []
    ys = []
    for i in range(len(data["mpg"])):
        # Inputs
        t = [float(data["cylinders"][i]), float(data["displacement"][i]), float(data["horsepower"][i]),
             float(data["weight"][i]), float(data["acceleration"][i])]
        xs.append(t)
        # Label
        ys.append(float(data["mpg"][i]))
    # Final set
    trainingData = [xs, ys]
    return trainingData

mpgData = getMPGDataset()

import sklearn as skl
from sklearn.neural_network import MLPRegressor
from sklearn.preprocessing import StandardScaler
scaler = StandardScaler()
scaler.fit(mpgData[0])
XTrain = scaler.transform(mpgData[0])

def getRegressor(hidden = ()):
    reg = MLPRegressor(hidden_layer_sizes = hidden,
                       activation = "relu",
                       learning_rate = "constant",
                       learning_rate_init = .01,
                       solver = "lbfgs",
                       verbose = False,
                       max_iter = 10000000,
                       tol = 1e-40)
    reg.fit(XTrain, mpgData[1])
    return reg

best = None
bestAccuracy = 0.0

for qq in range(1, 100):
    r = getRegressor((qq))
    # Find accuracy
    runner = 0.0
    for i in range(len(mpgData[0])):
        y_ = int(round(r.predict([XTrain[i]])[0]))
        if y_ in [mpgData[1][i] - 1, mpgData[1][i], mpgData[1][i] + 1]: runner += 1
    acc = runner / len(mpgData[0])
    print("Accuracy w/ H{0} :: {1}".format(qq, acc))
    if acc > bestAccuracy:
        bestAccuracy = acc
        best = r
        print("BEST ^^^^^^")

print(best.coefs_)
print(best.intercepts_)
print(best.loss_)

"""
97 Hidden
[array([[  2.06146695e+00,   2.29100958e+00,   3.54614397e+00,
          5.57359453e+00,   7.13812003e+00,  -9.47231951e-02,
         -7.03891778e-01,  -2.49711775e+00,  -4.83336909e-01,
          3.72676986e+00,  -7.59316009e-01,  -2.28130861e+00,
          2.11564806e+00,   1.33855140e-01,  -3.21541563e-01,
         -5.26763001e+00,  -5.11501997e+00,   3.16664866e-01,
         -2.26097020e+00,  -3.70127035e+00,   2.03338051e+00,
          2.09838318e+00,  -2.16828127e-01,   4.34626255e-01,
          2.76378405e-01,  -5.55693167e+00,   1.40582125e+00,
          6.19430177e-01,   3.23411802e+00,   4.00348999e-01,
          3.09843582e-01,   5.16741897e+00,   1.51508245e+00,
          5.52426568e+00,  -3.01970121e+00,   1.68362691e+00,
         -3.09031340e+00,  -2.66010627e-02,   4.58818386e+00,
         -2.14153789e+00,   5.06627885e+00,  -1.70304649e-02,
          4.16130746e+00,  -3.60516074e+00,   2.05224467e-01,
          1.42312945e-01,   1.96861765e+00,  -2.86859130e-03,
          6.77780029e+00,  -1.31390259e+00,  -3.84433615e+00,
         -2.51997547e+00,   1.92998189e+00,   5.43868322e+00,
          3.09820685e+00,  -2.68172273e+00,   4.94337599e-01,
          3.54243442e+00,   1.16090302e+00,  -4.68624303e+00,
          5.87733451e+00,   4.83106529e+00,  -5.28335507e+00,
         -3.19103140e+00,  -1.42907862e+00,   6.87986362e+00,
         -8.66838745e+00,   5.19693286e+00,   2.68549021e+00,
          1.30751660e+00,   1.44462655e-01,  -2.88811410e+00,
         -1.74141188e+00,   2.95403666e+00,  -5.42321673e-01,
          3.00819801e+00,  -1.04386498e+00,   9.63787659e-01,
         -1.12890291e-01,  -1.29226456e+00,  -4.95797952e+00,
         -1.45699727e+00,   1.00737815e+01,   2.27420705e+00,
         -3.07944804e-01,   8.82617044e-01,   3.51041033e+00,
         -2.92806470e+00,   2.57983501e+00,  -4.47565925e+00,
         -2.66859746e+00,  -6.56125584e-01,   8.23450730e-01,
          3.31181287e-01,  -9.24777017e-01,   6.25185872e-02,
          1.85024175e+00],
       [  4.14328238e+00,   6.41535939e+00,  -3.15944954e-01,
          2.70987472e+00,  -1.76620936e-01,  -9.28951079e-02,
         -1.49026695e+00,   4.24727721e+00,   5.67132055e+00,
         -9.29727775e-04,   6.61739950e+00,   2.32985652e+00,
         -1.12143571e+00,   5.29738715e-01,   1.52419429e+00,
         -8.12873896e+00,   6.24076852e+00,   2.53455930e+00,
         -8.14163969e+00,  -2.88256718e+00,  -1.11692579e+00,
         -5.86138046e+00,  -3.16960550e+00,   6.81053590e-01,
          3.14436791e+00,  -2.09772684e+00,   4.29553558e+00,
         -3.90418133e+00,  -1.55186899e+00,   2.19247547e+00,
         -6.18466526e-01,  -3.80658453e-01,   1.24878345e-01,
         -2.30354339e+00,  -6.18076908e+00,   2.26673356e+00,
          4.88238219e+00,  -9.43053168e-01,   5.52320543e-01,
          4.06670337e-01,  -1.89726440e+00,  -4.88376649e+00,
          1.64895107e+00,   3.23463551e+00,   6.37204612e+00,
         -6.96009549e-02,  -1.41808404e-01,  -5.08934259e-03,
         -4.51147194e+00,  -4.38050105e-01,  -2.10718150e+00,
          2.83461220e+00,   3.05125475e-01,  -3.10257656e+00,
         -1.27350437e+00,  -4.18590618e+00,   2.04678550e-01,
         -1.92918266e+00,   2.39231552e+00,   5.69283616e-01,
          3.36373123e+00,   1.37073290e-01,   1.21771225e+00,
         -4.22127648e+00,  -3.10164316e+00,   2.95056667e+00,
          1.91516025e+00,   7.78300643e+00,   2.90205588e-02,
          4.22700878e-01,   8.98673178e-01,  -4.17363900e-01,
         -4.04760523e-01,  -7.95669615e-01,   2.66036219e-01,
         -6.91369193e-01,  -2.29512702e+00,  -4.61047129e-01,
          1.53766754e-01,  -1.76694172e+00,  -2.28040509e+00,
          4.10379926e+00,  -4.37137600e+00,  -2.90101684e+00,
         -2.72147458e+00,  -4.42675085e-01,  -1.41539063e+00,
         -9.71886907e+00,   2.49266382e+00,  -2.85052324e+00,
         -4.58558327e+00,  -2.47591772e+00,   2.80278131e-01,
         -1.57682664e+00,   3.64371971e-01,  -3.96338674e+00,
         -7.28274730e+00],
       [ -1.16774911e-01,   9.09219641e-01,  -5.28838216e+00,
         -2.30261690e+00,   3.20788092e-02,  -3.69581213e-03,
         -3.34538215e-01,  -1.72406012e+00,  -1.64561509e-01,
         -2.26514624e+00,   9.35775779e-01,  -7.06269059e+00,
         -9.55515971e-01,  -6.89222918e-01,   1.74476706e+00,
          5.45811412e+00,   4.82782377e+00,  -8.98342093e+00,
         -1.24983187e+00,   3.79907578e+00,   2.44482629e+00,
         -2.29570370e+00,  -6.81432176e-01,   3.89422743e+00,
          1.67276212e+00,  -7.20070872e-01,   1.42929878e+00,
         -2.49067966e+00,  -2.67227865e+00,   3.16044899e+00,
          5.09334556e-02,   2.21814990e+00,  -5.72709734e+00,
         -4.44667948e+00,   2.08487534e+00,  -1.44047421e+00,
          6.23235761e-01,   5.93019442e-01,  -5.24542418e+00,
         -3.63486450e+00,   2.37726963e+00,  -1.13142582e+00,
          5.95986291e+00,  -3.49460394e+00,  -1.70586020e-01,
          3.96471651e-02,  -3.68089927e+00,  -1.66841001e-01,
          9.79013764e-01,   1.55267044e+00,  -1.05772375e+00,
          8.36683341e+00,  -3.63967443e-01,  -1.02601685e+00,
          9.22048744e-01,   9.70515502e-01,  -1.86202406e+00,
         -4.08573634e+00,   1.68268785e-02,  -4.19673819e+00,
         -3.30564264e-01,   1.70693383e-02,  -4.01420342e+00,
          1.00056774e+00,   5.89559721e+00,  -2.73416722e+00,
          3.91035958e+00,  -1.08453052e+00,   2.46618799e-01,
         -3.31670516e+00,   3.50301156e+00,  -2.34181001e+00,
          4.69246096e+00,  -1.43927305e+00,   4.61578567e+00,
         -7.17919061e+00,  -1.14197098e+00,  -4.21202067e+00,
         -1.50318110e-01,   1.31460288e-01,   9.98502453e+00,
         -2.12507969e-01,  -1.10405749e+00,  -2.17004593e+00,
         -3.75987246e+00,   2.79080653e+00,   6.47101721e-02,
          1.47952450e+00,  -1.18926529e+00,  -3.82128165e+00,
          1.89632473e+00,   4.03187162e+00,   4.08880851e+00,
          1.33567194e+00,   5.38064022e-01,   1.61789431e+00,
         -2.63110620e+00],
       [ -2.42862045e+00,  -3.69778691e+00,   2.27405210e+00,
         -4.54331116e+00,  -4.25974684e+00,   1.46656429e-01,
         -1.69767264e-01,   5.37302968e+00,  -6.57621552e-01,
          3.08930399e+00,   1.77925653e+00,   3.46543002e+00,
         -4.54659892e+00,  -1.78427788e-01,  -5.23783414e-01,
          5.04706162e-01,   1.57203014e+00,  -2.40900023e+00,
          1.89306457e+00,  -6.29920812e+00,  -4.48707929e-01,
          3.33024022e-01,  -2.69777531e-01,  -7.89601952e-01,
          2.61020940e+00,  -5.21974021e-01,   1.14414720e+00,
         -8.57932890e-01,   3.43513268e-02,   4.06829884e+00,
          9.35718726e-01,   4.39789755e+00,  -3.00125669e+00,
          1.53958240e+00,  -6.24035404e-01,  -7.29420043e-01,
         -5.47054536e+00,   1.27542990e-01,   4.35426921e+00,
          9.68862606e-01,  -3.19470856e+00,   5.18975139e+00,
         -2.95372144e-01,  -4.62358165e+00,   8.95113300e-01,
         -1.75922941e-02,   5.26565687e+00,  -9.46953514e-02,
         -6.31497806e-01,   2.68266999e+00,  -1.84120379e-01,
          7.61492325e-01,   8.28269510e-01,   6.32106052e-01,
          1.53664886e+00,  -9.24888330e-01,   1.05477729e+00,
         -1.33612636e-01,   2.07373581e+00,  -1.19392772e+00,
         -6.15149716e+00,  -5.12190344e+00,   4.30916612e+00,
         -5.15972334e+00,   1.46438643e+00,  -6.52870165e+00,
          6.56228621e+00,  -4.64743858e+00,  -4.20710618e+00,
          8.66360893e+00,   3.90625354e+00,  -3.78718482e+00,
          1.35572890e+00,  -1.94384115e+00,  -1.31005617e+00,
          2.51134756e+00,  -4.58345656e-01,  -2.22597501e-01,
          1.44282118e-02,  -3.28317220e+00,   1.21797741e+00,
         -2.35662162e+00,  -2.10870909e+00,   7.02281861e-01,
          7.27300390e-01,   7.57378185e-01,  -3.67269384e+00,
          5.60141730e-01,   4.91055858e+00,   1.61582731e+00,
          9.49469130e-01,  -4.05298214e+00,  -6.95625922e-02,
          1.74209364e+00,  -1.37656905e+00,   4.07315670e+00,
         -8.04568565e-01],
       [  1.79689238e+00,  -7.71484646e-01,   2.18928116e-01,
          1.41946785e+00,   4.75902371e+00,  -1.56682926e-02,
          4.90509714e-01,   5.48940167e+00,   6.06660303e+00,
          2.37741629e+00,  -6.36432178e+00,   3.13024687e+00,
          3.82349878e+00,   9.20897870e-02,  -1.39617324e+00,
         -4.25949616e-01,  -1.36697057e+00,   1.78536344e+00,
         -3.33517397e+00,  -4.09464780e+00,  -9.75331069e-01,
          4.07148909e+00,  -1.09784243e+00,  -4.22040058e+00,
          1.16696765e+00,  -5.74029124e+00,   3.79924490e-01,
          4.52819049e+00,  -4.29767403e+00,  -3.28298422e-01,
          3.63747608e-01,   3.01812961e+00,   2.83792721e+00,
         -6.26263108e+00,   1.26215269e+00,  -1.43581233e+00,
          5.77656203e-01,  -2.13525780e-01,  -7.17652007e-01,
          1.67272622e-01,  -7.12636361e+00,  -9.99629507e-01,
          5.53941742e+00,   2.98120079e+00,   2.55533360e+00,
         -8.39319768e-02,   2.65494752e+00,   2.04700654e-02,
          3.98907217e+00,   1.96689974e+00,   1.81639604e+00,
         -3.58180665e+00,  -4.58424368e+00,  -5.63316309e+00,
          1.35896249e+00,  -4.15689666e+00,   3.84168462e+00,
         -5.91772929e-02,  -2.74095547e+00,   4.06962395e+00,
          1.39582148e+00,   1.45409519e+00,   6.47016935e+00,
          4.30830074e-01,   4.17601233e-01,   1.44063816e+00,
         -2.32548035e+00,  -1.55685471e-01,   2.77330660e+00,
         -1.65657109e+00,   4.44203467e+00,   6.87912160e+00,
         -4.61533917e+00,  -5.26936882e-01,   2.17969662e+00,
          3.77128780e+00,   6.83342904e-01,   1.71873489e-01,
          3.42121909e-02,  -3.60319306e-01,   5.91882704e-01,
         -4.15330246e+00,   6.72155368e+00,  -1.25551895e+00,
         -2.66988753e+00,  -2.82446311e+00,   5.43509446e-01,
          5.93790306e-01,   1.27730686e+00,   2.86215221e+00,
         -8.57849782e-01,   1.97454045e+00,   8.20781827e-01,
         -2.87516350e+00,  -3.67634603e+00,  -1.10769717e+00,
          5.08184151e+00]]), array([[ -6.76441695e+00],
       [  7.12829314e+00],
       [  6.67641596e+00],
       [ -7.88749388e+00],
       [  1.03084725e+01],
       [ -1.67080773e-01],
       [ -1.84206865e+00],
       [ -7.94698824e+00],
       [  7.80328123e+00],
       [  5.60915758e+00],
       [ -8.05835140e+00],
       [  7.12686551e+00],
       [  5.57133498e+00],
       [  6.23072174e-01],
       [  2.71565215e+00],
       [ -1.09916352e+01],
       [  8.46221289e+00],
       [  1.11103314e+01],
       [ -9.73169414e+00],
       [  8.62844952e+00],
       [  3.12387584e+00],
       [ -6.58779875e+00],
       [ -2.97829607e+00],
       [  5.48203548e+00],
       [ -4.63124744e+00],
       [  7.33645001e+00],
       [ -5.35495396e+00],
       [  6.04583799e+00],
       [ -7.01896171e+00],
       [  5.59918310e+00],
       [ -1.04437109e+00],
       [  6.71330832e+00],
       [ -7.03097949e+00],
       [ -9.46148793e+00],
       [  4.17651302e+00],
       [ -1.92026887e+00],
       [ -7.31583355e+00],
       [  5.12295120e-01],
       [  7.07762099e+00],
       [ -3.69778280e+00],
       [  8.38287823e+00],
       [  6.35560972e+00],
       [ -9.19262511e+00],
       [  7.51938643e+00],
       [ -6.51312340e+00],
       [  5.62543627e-01],
       [  9.16652382e+00],
       [ -4.67950205e-01],
       [  9.14584042e+00],
       [  4.43277844e+00],
       [  3.11854907e-01],
       [ -8.46759342e+00],
       [ -5.28648619e+00],
       [  6.07903317e+00],
       [ -3.68425560e+00],
       [  5.37534961e+00],
       [ -6.56961808e+00],
       [  4.95377707e+00],
       [  3.64138554e+00],
       [ -7.73874023e+00],
       [ -8.31006082e+00],
       [  6.15275599e+00],
       [ -9.66173253e+00],
       [ -6.16971290e+00],
       [  6.28119558e+00],
       [  9.22305076e+00],
       [  1.66261601e+01],
       [  1.02851905e+01],
       [  9.61290155e+00],
       [ -8.78125548e+00],
       [  7.18342026e+00],
       [  8.30933330e+00],
       [ -4.81046184e+00],
       [ -3.62399567e+00],
       [  4.64688732e+00],
       [ -6.81584796e+00],
       [ -1.56541251e+00],
       [ -4.84568126e+00],
       [  1.12041825e-02],
       [ -4.65545510e+00],
       [ -1.34709674e+01],
       [ -9.95738169e+00],
       [ -1.34712669e+01],
       [ -4.09709988e+00],
       [ -4.36511440e+00],
       [  2.58112342e+00],
       [ -5.14319646e+00],
       [  8.08674439e+00],
       [ -5.96652875e+00],
       [ -5.71412784e+00],
       [ -4.09930261e+00],
       [  7.21561489e+00],
       [  3.65418037e+00],
       [  3.90883808e+00],
       [  5.91940577e+00],
       [ -5.18261687e+00],
       [  8.04036697e+00]])]
[array([ -5.13270894,   2.78890122,  -3.69292133,   1.57929201,
        -5.11218239,  -0.22852019,   1.60167813,   1.9258073 ,
         2.00690459,  -2.51334645,   4.17714331,   1.01529711,
         3.91252114,  -1.08005875,  -1.27735456,  -6.71896661,
         4.42932071,  -6.85652452,  -7.78188419,  -6.86859688,
        -0.54677818,  -1.47926175,   1.99286557,  -6.48500403,
        -3.7469616 ,  -1.24613635,  -4.75148586,  -3.75904668,
        -4.4014044 ,  -3.02769523,   1.27951043,  -0.05609155,
        -2.87447676,   1.42732518,   4.65008399,  -3.28815462,
        -1.18673779,  -1.54934661,   3.81728752,  -0.19213271,
         0.55137345,   1.38578892,   2.23987643,  -0.04841643,
         0.3614229 ,  -0.54568663,   6.02625055,  -0.5925325 ,
        -5.74286072,  -2.75965754,  -1.3166975 ,   7.53121715,
        -4.73312194,   1.37643754,  -2.77408355,  -1.54091512,
         5.87297305,   3.64226588,  -1.01885281,  -3.06205034,
        -0.9887979 ,   2.74337596,  -1.0665584 ,  -3.52552045,
         4.43938995,   4.33064515,  12.79932938,  -5.62036535,
        -8.75825048,   4.28175593,  -4.91337511,  -3.65705145,
        -2.52164968,   2.33234998,   0.8779876 ,   2.12172231,
        -0.90629168,   2.90371969,  -0.3542077 ,   3.82302804,
         8.16990521,   8.68875778,  -7.44132506,   2.41718299,
         1.25587168,  -4.83173676,   2.96727833,  -6.63998915,
        -0.66386512,   3.32423931,   1.93166585,  -4.00778717,
        -1.82459631,  -3.0405227 ,   5.97622521,  -1.36775552,  -2.45294529]), array([ 1.42911772])]"""
